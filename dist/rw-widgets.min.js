!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(){!function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["crisis-overview.hbs"]=a({1:function(a){var b,c=this.lambda,d=this.escapeExpression;return'  <div class="overview-widget--map">\n    <img src="'+d(c(null!=(b=null!=a?a.map:a)?b.src:b,a))+'" alt="'+d(c(null!=(b=null!=a?a.map:a)?b.alt:b,a))+'" />\n  </div>\n'},3:function(a,b,c,d){var e;return'  <div class="overview-widget--description">\n    <div class="accordion-set">\n'+(null!=(e=b.each.call(a,null!=a?a.content:a,{name:"each",hash:{},fn:this.program(4,d,0),inverse:this.noop,data:d}))?e:"")+"    </div>\n  </div>\n"},4:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression,j=this.lambda;return'      <input type="checkbox" id="'+i((f=null!=(f=b.key||d&&d.key)?f:g,typeof f===h?f.call(a,{name:"key",hash:{},data:d}):f))+'" class="accordion-set--check"'+(null!=(e=b["if"].call(a,d&&d.index,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.program(7,d,0),data:d}))?e:"")+'>\n      <label for="'+i((f=null!=(f=b.key||d&&d.key)?f:g,typeof f===h?f.call(a,{name:"key",hash:{},data:d}):f))+'" class="accordion-set--label"><h2>'+i(j(null!=a?a.title:a,a))+'</h2></label>\n      <div class="accordion-set--content" data-eq-pts="cols2: 500">\n        '+(null!=(e=j(null!=a?a.content:a,a))?e:"")+"\n      </div>\n"},5:function(){return""},7:function(){return' checked="checked"'},9:function(a,b,c,d){var e;return'  <div class="overview-widget--tabs tab-set">\n'+(null!=(e=b.each.call(a,null!=a?a.indicators:a,{name:"each",hash:{},fn:this.program(10,d,0),inverse:this.noop,data:d}))?e:"")+'    <div class="tab-set--content">\n'+(null!=(e=b.each.call(a,null!=a?a.indicators:a,{name:"each",hash:{},fn:this.program(12,d,0),inverse:this.noop,data:d}))?e:"")+"    </div>\n  </div>\n"},10:function(a,b,c,d){var e,f,g=b.helperMissing,h="function",i=this.escapeExpression;return'    <input type="radio" name="tab" id="tab-'+i((f=null!=(f=b.index||d&&d.index)?f:g,typeof f===h?f.call(a,{name:"index",hash:{},data:d}):f))+'" class="tab-set--tab"'+(null!=(e=b["if"].call(a,d&&d.index,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.program(7,d,0),data:d}))?e:"")+'/>\n    <label for="tab-'+i((f=null!=(f=b.index||d&&d.index)?f:g,typeof f===h?f.call(a,{name:"index",hash:{},data:d}):f))+'">'+i(this.lambda(null!=a?a.title:a,a))+"</label>\n"},12:function(a,b,c,d){var e,f,g=this.escapeExpression;return'      <div id="tab-body-'+g((f=null!=(f=b.index||d&&d.index)?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"index",hash:{},data:d}):f))+'" class="tab-set--body">\n        <h2>'+g(this.lambda(null!=a?a.title:a,a))+'</h2>\n        <i class="un-icon-crisis_population_displacement"></i>\n'+(null!=(e=b.each.call(a,null!=a?a.data:a,{name:"each",hash:{},fn:this.program(13,d,0),inverse:this.noop,data:d}))?e:"")+"      </div>\n"},13:function(a){var b=this.lambda,c=this.escapeExpression;return'        <div class="refugees">\n          <h3><span class="figure">'+c(b(null!=a?a.figure:a,a))+"</span> "+c(b(null!=a?a.quantifier:a,a))+"</h3>\n          <p>"+c(b(null!=a?a.description:a,a))+"</p>\n        </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g=b.helperMissing,h="function";return'<div class="overview-widget">\n  <h1 class="widget-title"><span><i class="un-icon-crisis_conflict widget-title--icon"></i>'+(null!=(f=null!=(f=b.adjustedTitle||(null!=a?a.adjustedTitle:a))?f:g,e=typeof f===h?f.call(a,{name:"adjustedTitle",hash:{},data:d}):f)?e:"")+"</span></h1>\n"+(null!=(e=b["if"].call(a,null!=a?a.map:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+(null!=(e=b["if"].call(a,null!=a?a.content:a,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+(null!=(e=b["if"].call(a,null!=a?a.indicators:a,{name:"if",hash:{},fn:this.program(9,d,0),inverse:this.noop,data:d}))?e:"")+'  <footer class="overview-widget--sources">'+(null!=(f=null!=(f=b.dataSource||(null!=a?a.dataSource:a))?f:g,e=typeof f===h?f.call(a,{name:"dataSource",hash:{},data:d}):f)?e:"")+"</footer>\n</div>\n"},useData:!0})}()},{}],2:[function(a,b){(function(c){"use strict";function d(a){for(var b='<span class="word[[counter]]">[[word]]</span>',c=a.split(" "),d="",e=0;e<c.length;e++)d+=b.replace("[[counter]]",e+1).replace("[[word]]",c[e]);return d}var e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f=("undefined"!=typeof window?window.d3:"undefined"!=typeof c?c.d3:null,"undefined"!=typeof window?window.$:"undefined"!=typeof c?c.$:null),g=("undefined"!=typeof window?window.BeatBlocks:"undefined"!=typeof c?c.BeatBlocks:null).helpers.widgetBase;a("./crisis-overview.hbs.js");var h=function(a){var b={title:"Crisis Overview",template:"crisis-overview.hbs",map:{src:"",alt:""}};a=a?a:{},b=e.defaults(a,b),g.call(this,b)};h.prototype=new g,h.prototype.compile=function(a,b){var c=this.config();this.config("adjustedTitle",d(c.title)),this.template(function(c){a.classed("rw-widget",!0).html(c),b()})},h.prototype.link=function(){f(".overview-widget a").attr("target","_blank")},b.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./crisis-overview.hbs.js":1}],3:[function(){!function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["financial.hbs"]=a({1:function(a,b,c,d){var e;return'    <a href="" class="financial-widget--data-source">'+this.escapeExpression((e=null!=(e=b.dataItemTitle||(null!=a?a.dataItemTitle:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"dataItemTitle",hash:{},data:d}):e))+"</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g,h=b.helperMissing,i="function",j=this.escapeExpression,k='<div class="financial-widget">\n  <h1 class="widget-title"><span><i class="un-icon-activity_fund widget-title--icon"></i>'+(null!=(f=null!=(f=b.adjustedTitle||(null!=a?a.adjustedTitle:a))?f:h,e=typeof f===i?f.call(a,{name:"adjustedTitle",hash:{},data:d}):f)?e:"")+'</span></h1>\n  <div class="financial-widget--data-source-chooser">\n';return f=null!=(f=b.dataSources||(null!=a?a.dataSources:a))?f:h,g={name:"dataSources",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d},e=typeof f===i?f.call(a,g):f,b.dataSources||(e=b.blockHelperMissing.call(a,e,g)),null!=e&&(k+=e),k+'  </div>\n  <div class="financial-widget--time">\n    <h1>'+j((f=null!=(f=b.dataItemTitleCurrent||(null!=a?a.dataItemTitleCurrent:a))?f:h,typeof f===i?f.call(a,{name:"dataItemTitleCurrent",hash:{},data:d}):f))+'</h1>\n    <select class="financial-widget--time-select" name="time-chooser" id="">\n    </select>\n  </div>\n  <div class="financial-widget--percent-funded">\n    <div class="financial-widget--percent-funded--amount covered">$2.12B Funded <span class="percent">57% <span>covered</span></span>\n    </div>\n    <div class="financial-widget--percent-funded--amount requested ">$3.74B Requested</div>\n  </div>\n  <div class="financial-widget--cluster-funding">\n    <h2>Requirements &amp; Funding Per Cluster</h2>\n    <div id="finance-bubbles"></div>\n  </div>\n  <footer class="financial-widget--explore"><a href="'+j((f=null!=(f=b.fundingDocumentURL||(null!=a?a.fundingDocumentURL:a))?f:h,typeof f===i?f.call(a,{name:"fundingDocumentURL",hash:{},data:d}):f))+'" target="_blank">Explore Funding Documents via ReliefWeb</a></footer>\n  <footer class="financial-widget--sources">Data Source <cite><a href="'+j((f=null!=(f=b.dataSourceURL||(null!=a?a.dataSourceURL:a))?f:h,typeof f===i?f.call(a,{name:"dataSourceURL",hash:{},data:d}):f))+'" target="_blank">Financial Tracking Service</a></cite></footer>\n</div>\n'},useData:!0})}()},{}],4:[function(a,b){(function(c){"use strict";function d(a){for(var b='<span class="word[[counter]]">[[word]]</span>',c=a.split(" "),d="",e=0;e<c.length;e++)d+=b.replace("[[counter]]",e+1).replace("[[word]]",c[e]);return d}var e="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,f=("undefined"!=typeof window?window.BeatBlocks:"undefined"!=typeof c?c.BeatBlocks:null).helpers.widgetBase,g="undefined"!=typeof window?window.$:"undefined"!=typeof c?c.$:null,h="undefined"!=typeof window?window.d3:"undefined"!=typeof c?c.d3:null,i="undefined"!=typeof window?window.moment:"undefined"!=typeof c?c.moment:null;a("./financial.hbs.js");var j=function(a){var b={title:"Financial Support",template:"financial.hbs"};a=a?a:{},b=e.defaults(a,b),f.call(this,b)};j.prototype=new f,j.prototype.compile=function(a,b){function c(a){var b=a/1e9;return b>1?b=b.toFixed(2)+" B":(b=a/1e6,b=b.toFixed(2)+" M"),b}var e=this,f={},h=e.config("dataSources");h.forEach(function(a){var b,d,e;b=d=e=0,g.each(a.clusters,function(){b+=this.current_requirement,d+=this.pledges,e+=this.funding});var h=e/b*100;h=h.toFixed(2),b=c(b),d=c(d),e=c(e),f[a.dataItemTitle]={currentRequirementTotal:b,pledgesTotal:d,fundingTotal:e,percentageRaised:h}}),this.config("calculatedDataSources",f);var i=this.config();this.config("adjustedTitle",d(i.title)),e.template(function(c){a.classed("rw-widget",!0).html(c),b()});var j=h[0].dataSourceURL;g(".financial-widget--sources a").attr("href",j)},j.prototype.link=function(a){function b(){d(),c(),g(".financial-widget--data-source-chooser :first-child",p).toggleClass("active"),f(),g(".financial-widget--data-source",p).click(function(a){a.preventDefault();var b=this.text;r.currentSection=e.findKey(o.dataSources,function(a){return a.dataItemTitle==b}),o.dataSources[r.currentSection].clusters.length<=1?g(".financial-widget--cluster-funding",p).hide():g(".financial-widget--cluster-funding",p).show(),c(),j(b),m(b),g(".financial-widget--data-source").removeClass("active"),g(this).toggleClass("active");var d=o.dataSources[r.currentSection].dataSourceURL;g(".financial-widget--sources a").attr("href",d)})}function c(){function b(a){var b=a.r+16,c=a.x-b,d=a.x+b,e=a.y-b,f=a.y+b;return function(b,g,h,i,j){if(b.point&&b.point!==a){var k=a.x-b.point.x,l=a.y-b.point.y,m=Math.sqrt(k*k+l*l),n=a.r+b.point.r;n+="horizontal"==r.direction?40:20,n>m&&(m=(m-n)/m*.5,a.x-=k*=m,a.y-=l*=m,b.point.x+=k,b.point.y+=l)}return g>d||c>i||h>f||e>j}}function c(a){var b,c=h.format("%"),e=w.append("g").attr("id","detail-overlay").style("display","block");e.append("rect").classed("detail--block",!0).attr({x:0,y:0,width:j+i.left+i.right,height:k+i.top+i.bottom}),e.append("circle").classed("detail--info",!0).attr({"stroke-width":5,cx:j/2,cy:k/2,r:k>j?j/2-10:k/2-10});var f=e.append("g").classed("detail--text",!0);f.append("text").classed("detail--title",!0).attr({"text-anchor":"middle"}).text(a.title),f.append("text").attr({"text-anchor":"middle",transform:"translate(0,20)"}).text(c(a.fundingPercentage)+" funded"),b=h.formatPrefix(a.requested),f.append("text").attr({"text-anchor":"middle",transform:"translate(0,40)"}).text(b.scale(a.requested).toFixed(2)+b.symbol+" Requested"),b=h.formatPrefix(a.funded),f.append("text").attr({"text-anchor":"middle",transform:"translate(0,60)"}).text(b.scale(a.funded).toFixed(2)+b.symbol+" Funded");var g=f.node().getBBox(),l=j/2+10,m=k/2-g.height/2+i.top+10;f.attr({transform:"translate("+l+","+m+")"}),e.append("rect").attr({x:0,y:0,width:j+i.left+i.right,height:k+i.top+i.bottom,fill:"none"}).style("pointer-events","all").on("click",function(){d()})}function d(){h.select("#detail-overlay").remove()}function e(a,b){a.each(function(){var a,c=h.select(this),d=c.text().split(/\s+/).reverse(),e=[],f=0,g=20,i=c.attr("y"),j=0,k=c.text(null).append("tspan").attr("x",0).attr("y",i).attr("dy",j+"em");for(a=d.pop();a;)e.push(a),k.text(e.join(" ")),k.node().getComputedTextLength()>b&&(e.pop(),k.text(e.join(" ")),e=[a],k=c.append("tspan").attr("x",0).attr("y",i).attr("y",++f*g+j+"px").text(a)),a=d.pop()})}var f=o.dataSources[r.currentSection].clusters;if(g("#finance-bubbles",p).empty(),!(f.length<=1)){var i={top:20,bottom:20,left:50,right:20},j=g("#finance-bubbles",p).width()-i.left-i.right,k="horizontal"==r.direction?500:680;k=k-i.top-i.bottom;var l="horizontal"==r.direction?25e3:4e3,m=h.scale.linear().domain(h.extent(f,function(a){return a.funding})).range([1e3,l]),n="horizontal"==r.direction?[0,j]:[k,0],q=h.scale.linear().domain([0,1]).range(n),s=function(a){return a.r<50},t=function(a){return a},u=function(){var a=!1,b=r.direction;j=g("#finance-bubbles").width(),w.attr("width",j),j=j-i.left-i.right,r.direction=g("#finance-bubbles").width()>650?"horizontal":"vertical",a=r.direction!==b;var c="horizontal"==r.direction?25e3:4e3;m.range([1e3,c]),A.innerTickSize(-j),a&&(k="horizontal"==r.direction?500:680,w.attr("height",k),k=k-i.top-i.bottom,z.innerTickSize(-k),v.forEach(function(a,b){v[b].r=Math.sqrt(m(a.funded)/Math.PI),v[b].x="horizontal"==r.direction?q(a.fundingPercentage):j/2+(4*Math.random()-2),v[b].y="horizontal"==r.direction?k/2+(4*Math.random()-2):q(a.fundingPercentage)}),D.classed({small:s}),D.selectAll("circle").attr({r:function(a){return a.r}}),D.selectAll("text").attr({transform:function(a){return s(a)?"translate(0,"+(a.r+16)+")":""}}),D.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})),C&&(C.size([j,k]),C.start()),"horizontal"==r.direction?(q.range([0,j]),B.select(".grid.x").style("display","block").call(z),B.select(".axis.x").attr("transform","translate(0,"+k+")").style("display","block").call(x),B.select(".axis.y").style("display","none"),B.select(".grid.y").style("display","none")):(q.range([k,0]),B.select(".axis.x").style("display","none"),B.select(".grid.x").style("display","none"),B.select(".axis.y").style("display","block").call(y),B.select(".grid.y").style("display","block").call(A))};g(window).resize(function(){u()});var v=h.range(f.length).map(function(a){var b=f[a].current_requirement?f[a].funding/f[a].current_requirement:0;return{title:t(f[a].name),fundingPercentage:b,requested:f[a].original_requirement,funded:f[a].funding,r:Math.sqrt(m(f[a].funding)/Math.PI),x:"horizontal"==r.direction?q(b):j/2+(4*Math.random()-2),y:"horizontal"==r.direction?k/2+(4*Math.random()-2):q(b)}}).sort(function(a,b){return b.fundingPercentage-a.fundingPercentage}),w=a.select("#finance-bubbles").append("svg").attr({width:j+i.left+i.right,height:k+i.top+i.bottom}),x=h.svg.axis().scale(q).tickValues([0,.25,.5,.75,1]).tickFormat(function(a){return 100*a+"%"}).orient("bottom"),y=h.svg.axis().scale(q).tickValues([0,.25,.5,.75,1]).tickFormat(function(a){return 100*a+"%"}).orient("left"),z=h.svg.axis().scale(q).orient("top").tickFormat("").innerTickSize(-k).outerTickSize(0).tickValues([0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1]),A=h.svg.axis().scale(q).orient("left").tickFormat("").innerTickSize(-j).outerTickSize(0).tickValues([0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1]),B=w.append("g").attr("transform","translate("+i.left+","+i.top+")");B.append("g").classed({x:!0,axis:!0}).attr("transform","translate(0,"+k+")").call(x),B.append("g").classed({y:!0,axis:!0}).attr("transform","translate(0,0)").call(y),B.append("g").classed({x:!0,grid:!0}).attr("transform","translate(0,0)").call(z),B.append("g").classed({y:!0,grid:!0}).attr("transform","translate(0,0)").call(A);var C=h.layout.force().gravity(0).friction(.8).nodes(v).size([j,k]),D=B.selectAll(".cluster-bubble").data(v).enter().append("g").classed({"cluster-bubble":!0,small:s}).style({cursor:"pointer"}).attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).on("click",function(a){c(a)});D.append("circle").attr({r:function(a){return a.r}}),D.append("text").text(function(a){return a.title}).style("text-transform","capitalize").attr({"text-anchor":"middle",transform:function(a){return s(a)?"translate(0,"+(a.r+16)+")":""}}),D.selectAll("text").call(e,200),u(),C.on("tick",function(a){var c=h.geom.quadtree(v),d=.1*a.alpha;v.forEach(function(a){"horizontal"==r.direction?(a.x+=(q(a.fundingPercentage)-a.x)*d,a.y=a.y>k/2?a.y-3*d:a.y+3*d):(a.y+=(q(a.fundingPercentage)-a.y)*d,a.x=a.x>j/2?a.x-d:a.x+d),a.x+a.r>j?a.x-=400*d:a.x-a.r<0&&(a.x+=400*d),a.y+a.r+20>k?a.y-=400*d:a.y-a.r<0&&(a.y+=400*d),c.visit(b(a))}),D.attr("transform",function(a){return"translate("+a.x+","+a.y+")"})})}}function d(){for(var a=g('select[name="time-chooser"]',p),b=i().subtract(1,"years").format("YYYY"),c="",d=0;4>d;d++)c=2015==b?"selected":"",a.append('<option value="'+b+'"'+c+">"+b+"</option>"),b--;a.selectric()}function f(){var a=Object.keys(q)[0];m(a)}function j(a){g(".financial-widget--time h1").text(a)}function k(a,b){var c="$"+a+' Funded <span class="percent">'+b+"% <span>covered</span></span>";g(".financial-widget--percent-funded .covered").width(b-20+"%").html(c)}function l(a){g(".financial-widget--percent-funded .requested").html("$"+a+" Requested")}function m(a){var b=q[a];k(b.fundingTotal,b.percentageRaised),l(b.currentRequirementTotal)}var n=this,o=n.config(),p=g(a[0][0]),q=o.calculatedDataSources,r={direction:g("#finance-bubbles").width()>650?"horizontal":"vertical",currentSection:0};b()},b.exports=j}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./financial.hbs.js":3}],5:[function(){!function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["river.hbs"]=a({1:function(a,b,c,d){var e,f=b.helperMissing,g="function",h=this.escapeExpression;return'        <li class="widget-river--results--item">\n          <span class="widget-river--results--number">'+h((e=null!=(e=b.count||(null!=a?a.count:a))?e:f,typeof e===g?e.call(a,{name:"count",hash:{},data:d}):e))+'</span>\n\n          <div class="widget-river--results--type">\n            <span class="'+h((e=null!=(e=b.icon||(null!=a?a.icon:a))?e:f,typeof e===g?e.call(a,{name:"icon",hash:{},data:d}):e))+'"></span>\n            '+h((e=null!=(e=b.title||(null!=a?a.title:a))?e:f,typeof e===g?e.call(a,{name:"title",hash:{},data:d}):e))+"\n          </div>\n        </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g,h=b.helperMissing,i="function",j='<div class="widget-river">\n  <h1 class="widget-title"><span><i class="un-icon-product_type_report widget-title--icon"></i>'+(null!=(f=null!=(f=b.adjustedTitle||(null!=a?a.adjustedTitle:a))?f:h,e=typeof f===i?f.call(a,{name:"adjustedTitle",hash:{},data:d}):f)?e:"")+'</span></h1>\n  <header class="widget-river--header">\n    <h1 class="widget-river--title">I want content from</h1>\n    <select>\n      <option value="weeks" >This week</option>\n      <option value="months">This month</option>\n      <option value="years">This year</option>\n    </select>\n  </header>\n  <div class="widget-river--results clearfix">\n    <div class="widget-river--results--graph">\n      <ul class="widget-river--results-tabs clearfix">\n';return f=null!=(f=b.content||(null!=a?a.content:a))?f:h,g={name:"content",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d},e=typeof f===i?f.call(a,g):f,b.content||(e=b.blockHelperMissing.call(a,e,g)),null!=e&&(j+=e),j+'      </ul>\n      <div class="placeholder">\n        <p class="graph--heading"></p>\n        <svg id="chart"></svg>\n      </div>\n    </div>\n    <div class="widget-river--filters">\n      <h5 class="widget-river--filters--title">Filter Results:  <span class="tab">Reports</span> <span class="close"></span></h5>\n      <ul></ul>\n    </div>\n  </div>\n</div>\n'},useData:!0})}()},{}],6:[function(a,b){(function(c){"use strict";var d="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,e=("undefined"!=typeof window?window.BeatBlocks:"undefined"!=typeof c?c.BeatBlocks:null).helpers.widgetBase,f="undefined"!=typeof window?window.$:"undefined"!=typeof c?c.$:null,g="undefined"!=typeof window?window.moment:"undefined"!=typeof c?c.moment:null,h="undefined"!=typeof window?window.reliefweb:"undefined"!=typeof c?c.reliefweb:null,i="undefined"!=typeof window?window.d3:"undefined"!=typeof c?c.d3:null;a("./river.hbs.js");var j=function(a){var b={title:"More Information",template:"river.hbs"};a=a?a:{},b=d.defaults(a,b),e.call(this,b)};j.prototype=new e,j.prototype.compile=function(a,b){function c(a){for(var b='<span class="word[[counter]]">[[word]]</span>',c=a.split(" "),d="",e=0;e<c.length;e++)d+=b.replace("[[counter]]",e+1).replace("[[word]]",c[e]);return d}var d=this,e=this.config();this.config("adjustedTitle",c(e.title)),d.getData("weeks",function(c){d.config("content",c),d.template(function(c){a.classed("rw-widget",!0).html(c),b()});var e=d.config("timePeriod"),h=g(e.startDate,"MM-DD-YYYY").utc().format("Do MMMM YYYY")+" - "+g(e.endDate,"MM-DD-YYYY").utc().format("Do MMMM YYYY");f(".widget-river--results--graph .graph--heading").html(h),d.getChart()})},j.prototype.link=function(a){function b(){f("select",i).selectric(),f(".widget-river--results--item").click(function(){var a=f(this).find(".widget-river--results--type span").attr("class");c(a),f(".widget-river--filters").addClass("open")}),f(".close").click(function(){f(".widget-river--filters").removeClass("open")}),f(".widget-river--header select",i).on("selectric-change",function(){var a=f(this).val();j.getData(a,function(a){j.config("content",a),e(a)})}),c(k[0].icon)}function c(a){var b=d.findIndex(k,{icon:a}),c=k[b],e="";c.filters.forEach(function(a){e+='<li><a href="'+a.location+'" target="_blank">'+a.linkTitle+"</a></li>"}),f(".widget-river--filters ul").html(e),f(".widget-river--filters").removeClass("results--item--reports results--item--maps results--item--jobs"),"disasters"==c.type&&(c.type="jobs"),f(".widget-river--filters").addClass("results--item--"+c.type),f(".widget-river--filters--title .tab").html(c.title)}function e(a){f("li.widget-river--results--item .widget-river--results--number").each(function(b){f(this).html(h(a[b].count))});var b=j.config("timePeriod"),c="";c="years"==b.duration?g(b.startDate,"MM-DD-YYYY").utc().format("MMMM YYYY")+" - "+g(b.endDate,"MM-DD-YYYY").utc().format("MMMM YYYY"):g(b.startDate,"MM-DD-YYYY").utc().format("Do MMMM YYYY")+" - "+g(b.endDate,"MM-DD-YYYY").utc().format("Do MMMM YYYY"),f(".widget-river--results--graph .graph--heading").html(c),f("#chart").html(""),j.getChart()}function h(a){return(a+"").replace(/(\d)(?=(\d{3})+$)/g,"$1,")}var i=f(a[0][0]),j=this,k=j.config("content");b()},j.prototype.getChart=function(){function a(){e=b(),c(e)}function b(){for(var a=h.config("content"),b=h.config("timePeriod"),c=g(b.endDate,"MM-DD-YYYY"),e=g(b.startDate,"MM-DD-YYYY"),f=[],i=e;i.isBefore(c);i.add(1,"day"))f.push(i.utc().format("MM-DD-YYYY"));var j=[];return j.max=0,a.forEach(function(a){j[a.type]=[];var c=[];a.graphData&&a.graphData.forEach(function(d){var e=g(d.value,g.ISO_8601).utc().format("MM-DD-YYYY"),f=d.count/a.count*100;f>j.max&&(j.max=f),"years"!=b.duration?c.push({date:e,total:f}):j[a.type].push({date:e,total:f})}),"years"!=b.duration&&f.forEach(function(b){var e=d.findIndex(c,{date:b});j[a.type].push(-1==e?{date:b,total:0}:c[e])})}),j.max=5*Math.ceil((j.max+1)/5),j}function c(a){var b,c,e=h.config("timePeriod"),j={top:40,right:30,bottom:40,left:50},k=f("#chart").parent().width(),l=500,m=i.time.scale().domain([g(e.startDate,"MM-DD-YYYY").toDate(),g(e.endDate,"MM-DD-YYYY").toDate()]).rangeRound([0,k-j.left-j.right]),n=i.scale.linear().domain([0,a.max]).range([l-j.top-j.bottom,0]);switch(e.duration){case"weeks":b=i.time.days,c=i.time.format("%d %b");break;case"months":b=i.time.weeks,c=i.time.format("%d %b");break;case"years":b=i.time.months,c=i.time.format("%b %Y")}var o=i.svg.axis().scale(m).orient("bottom").ticks(b,1).tickFormat(function(a,b){return f(window).width()<400&&b%2?"":c(a)}).tickSize(-l+j.top+j.bottom,0,0).tickPadding(8),p=i.svg.axis().scale(n).orient("left").tickFormat(function(a){return 0===a?"":a+"%"}).tickSize(-k+j.left+j.right,0,0).tickPadding(8),q=i.select("#chart").attr("class","chart").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+k+" "+l).append("g").attr("transform","translate("+j.left+", "+j.top+")");q.append("g").attr("class","x axis").attr("transform","translate(0, "+(l-j.top-j.bottom)+")").call(o),q.append("g").attr("class","y axis").call(p);var r=i.svg.line().x(function(a){return m(g(a.date,"MM-DD-YYYY").toDate())}).y(function(a){return n(a.total)});delete a.max,d.keys(a).forEach(function(b){var c=b;"disasters"==b&&(c="jobs"),q.append("path").attr("class","graph-"+c).attr("d",r(a[b])).attr("stroke-width",7).attr("fill","none")})}var e,h=this;f(window).resize(function(){f("#chart").html(""),c(e)}),a()},j.prototype.getData=function(a,b){var c=this,d=g().utc().format(),e=g().utc().subtract(1,a).format(),f=c.config("countries"),i=c.config("content"),j="day";"years"==a&&(j="month"),c.config("timePeriod",{duration:a,startDate:g(e,g.ISO_8601).utc().format("MM-DD-YYYY"),endDate:g(d,g.ISO_8601).utc().format("MM-DD-YYYY")});var k={facets:[{field:"date.created",interval:j}]},l=0,m=h.client();i.forEach(function(a,c){var g,h={filter:{operator:"AND",conditions:[{field:"date.created",value:{from:e,to:d}}]}};Array.isArray(f)&&f.length&&h.filter.conditions.push({field:"country.name",value:f,operator:"OR"}),"maps"==a.type?(g="reports",h.filter.conditions.push({field:"format.name",value:["Map","Infographic"],operator:"OR"})):g=a.type,m.post(g).send({preset:"analysis",limit:0}).send(k).send(h).sort("date.created","asc").end(function(a,d){a||(l++,i[c].count=d.body.totalCount,i[c].graphData=d.body.embedded.facets["date.created"].data,l==i.length&&b(i))})})},b.exports=j}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./river.hbs.js":5}],7:[function(){!function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["timeline.hbs"]=a({1:function(a,b,c,d){var e,f=b.helperMissing,g="function",h=this.escapeExpression;return'              <li class="timeline-widget-dropdown--list-item" data-slide="'+h((e=null!=(e=b.index||d&&d.index)?e:f,typeof e===g?e.call(a,{name:"index",hash:{},data:d}):e))+'">\n                <div class="timeline-widget-dropdown--item">\n                  <div class="timeline-widget-dropdown--item-date">'+h((e=null!=(e=b["date-day"]||(null!=a?a["date-day"]:a))?e:f,typeof e===g?e.call(a,{name:"date-day",hash:{},data:d}):e))+" "+h((e=null!=(e=b["date-month"]||(null!=a?a["date-month"]:a))?e:f,typeof e===g?e.call(a,{name:"date-month",hash:{},data:d}):e))+" "+h((e=null!=(e=b["date-year"]||(null!=a?a["date-year"]:a))?e:f,typeof e===g?e.call(a,{name:"date-year",hash:{},data:d}):e))+'</div>\n                  <div class="timeline-widget-dropdown--item-desc">'+h((e=null!=(e=b["short-desc"]||(null!=a?a["short-desc"]:a))?e:f,typeof e===g?e.call(a,{name:"short-desc",hash:{},data:d}):e))+"</div>\n                </div>\n              </li>\n"},3:function(a){var b,c=this.lambda,d=this.escapeExpression;return'          <li class="timeline-widget-item">\n            <div class="timeline-widget-item--header">\n              <div class="timeline-widget-item--headline">\n                <div class="timeline-widget-item--category">Ocha <div class="arrow"></div></div> <div class="timeline-widget-item--date">'+d(c(null!=a?a["date-full"]:a,a))+'</div>\n              </div>\n              <h1 class="timeline-widget-item--title">'+d(c(null!=a?a.title:a,a))+'</h1>\n            </div>\n            <div class="timeline-widget-item--content">\n                  <div class="timeline-widget-item--image">\n                    <div class="timeline-widget-item--image--icons">\n                      <a class="timeline-widget-item--image--view-more"><img src="../../images/eye-img--yellow.png"></a>\n                      <a class="timeline-widget-item--image--country">'+d(c(null!=a?a.country:a,a))+'</a>\n                    </div>\n                    <img src="'+d(c(null!=a?a["img-src"]:a,a))+'" />\n                  </div>\n              <div class="timeline-widget-item--description">\n                  '+(null!=(b=c(null!=a?a["long-desc"]:a,a))?b:"")+'\n                <div class="timeline-widget-item-link">\n                  <a class="btn" href="'+d(c(null!=a?a.url:a,a))+'"><span class="un-icon-product_type_report"></span> Read full report</a>\n                </div>\n              </div>\n            </div>\n          </li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f,g,h=b.helperMissing,i="function",j='<div class="timeline-widget">\n  <h1 class="widget-title"><span><i class="un-icon-product_type_calendar widget-title--icon"></i>'+(null!=(f=null!=(f=b.adjustedTitle||(null!=a?a.adjustedTitle:a))?f:h,e=typeof f===i?f.call(a,{name:"adjustedTitle",hash:{},data:d}):f)?e:"")+'</span></h1>\n  <div class="timeline-widget--controls">\n    <button class="prev"><div class="arrow"></div></button>\n    <button class="next"><div class="arrow"></div></button>\n  </div>\n\n  <div class="timeline-widget--dropdown">\n    <div class="timeline-widget--dropdown-heading">\n      <span class="button-arrow"></span> Timeline - Calendar</div>\n    <div class="clear"></div>\n    <div class="timeline-widget--dropdown--wrapper">\n      <div class="timeline-widget--dropdown-controls">\n        <div class="form-select">\n          <select name="year">\n          </select>\n        </div>\n        <div class="form-select">\n          <select name="month">\n          </select>\n        </div>\n        <button class="form-today">Today</button>\n        <span class="close"></span>\n      </div>\n      <div class="timeline-widget--dropdown--container">\n        <ul class="slidee">\n';return f=null!=(f=b["timeline-items"]||(null!=a?a["timeline-items"]:a))?f:h,g={name:"timeline-items",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d},e=typeof f===i?f.call(a,g):f,b["timeline-items"]||(e=b.blockHelperMissing.call(a,e,g)),null!=e&&(j+=e),j+'          <li class="timeline-widget--dropdown--end-of-line">No More Entries</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <div class="timeline-widget--frames">\n    <ul class="slidee">\n'+(null!=(e=b.each.call(a,null!=a?a["timeline-items"]:a,{name:"each",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+'    </ul>\n    <div class="clear"></div>\n  </div>\n</div>'},useData:!0})}()},{}],8:[function(a,b){(function(c){"use strict";var d="undefined"!=typeof window?window._:"undefined"!=typeof c?c._:null,e=("undefined"!=typeof window?window.d3:"undefined"!=typeof c?c.d3:null,("undefined"!=typeof window?window.BeatBlocks:"undefined"!=typeof c?c.BeatBlocks:null).helpers.widgetBase),f="undefined"!=typeof window?window.$:"undefined"!=typeof c?c.$:null,g="undefined"!=typeof window?window.moment:"undefined"!=typeof c?c.moment:null,h="undefined"!=typeof window?window.reliefweb:"undefined"!=typeof c?c.reliefweb:null;a("./timeline.hbs.js");var i=function(a){var b={title:"Crisis Timeline",template:"timeline.hbs",countries:[]};a=a?a:{},b=d.defaults(a,b),e.call(this,b)};i.prototype=new e,i.prototype.compile=function(a,b){function c(a){for(var b='<span class="word[[counter]]">[[word]]</span>',c=a.split(" "),d="",e=0;e<c.length;e++)d+=b.replace("[[counter]]",e+1).replace("[[word]]",c[e]);return d}var d=this,e=this.config();this.config("adjustedTitle",c(e.title));var f=d.config("countries"),i=d.config("disaster"),j=g(d.config("startDate"),g.ISO_8601).utc().format(),k=10;d.has("limit")&&(k=d.config("limit"));var l={filter:{operator:"AND",conditions:[{field:"headline.featured"},{field:"date.original",value:{from:j}}]}};Array.isArray(f)&&f.length&&l.filter.conditions.push({field:"country",value:f,operator:"OR"}),Array.isArray(i)&&i.length&&l.filter.conditions.push({field:"disaster",value:i,operator:"OR"});var m=h.client();m.post("reports").fields(["date","headline","primary_country","url"],[]).sort("date.original","asc").send(l).send({limit:k}).end(function(c,e){if(!c){var f=[];
e.body.data.forEach(function(a,b){var c=0!==b?g(f[b-1]["date-full"],"DD MMM YYYY").month():-1,d={title:a.fields.headline.title,country:a.fields.primary_country.name,"long-desc":a.fields.headline.summary,"short-desc":a.fields.headline.title,url:a.fields.url};a.fields.headline.image&&(d["img-src"]=a.fields.headline.image.url);var e=g(a.fields.date.original,g.ISO_8601);d["date-full"]=e.format("DD MMM YYYY"),d["date-month"]=e.format("MMMM"),d["date-day"]=e.format("DD"),d["date-year"]=e.format("YYYY"),d["new-month"]=c!==e.month(),f.push(d)}),d.config("timeline-items",f),d.template(function(c){a.classed("rw-widget",!0).html(c),b()})}})},i.prototype.link=function(a){function b(){var a,b=g().unix(),c=0;return p.forEach(function(d,e){var f=g(d["date-full"],"DD MMM YYYY").unix();(void 0===a||Math.abs(b-f)<a)&&(a=Math.abs(b-f),c=e)}),c}function c(){o.currentIndex=b();var a=g(p[o.currentIndex]["date-full"],"DD MMM YYYY");o.currentYear=a.format("YYYY"),o.currentMonth=a.format("M"),o.currentFormatted=a.format("YYYY MMMM"),d(),f("select",q).selectric(),j=f(".timeline-widget--frames",q),k=f(".timeline-widget-item",q),l="40px",i(j.width()),k.css({marginRight:l}),f(window).resize(function(){i(j.width())}),m=new Sly(j,{horizontal:1,itemNav:"forceCentered",smart:1,activateMiddle:1,mouseDragging:1,touchDragging:1,releaseSwing:1,startAt:o.currentIndex,speed:200,elasticBounds:1,dragHandle:1,dynamicHandle:1,clickBar:1,prev:f(".prev"),next:f(".next")}).init(),n=new Sly(f(".timeline-widget--dropdown--container",q),{itemNav:"basic",smart:1,activateOn:"click",mouseDragging:1,touchDragging:1,releaseSwing:1,scrollBy:1,startAt:o.currentIndex,activatePageOn:"click",speed:300,elasticBounds:1,dragHandle:1,dynamicHandle:1,clickBar:1}).init(),e()}function d(){var a=g.months(),b=g.monthsShort("-MMM-"),c=f('select[name="month"]',q);a.forEach(function(a,d){c.append('<option value="'+b[d]+'">'+a+"</option>")});for(var d=f('select[name="year"]',q),e=o.currentYear,h=0;5>h;h++)d.append('<option value="'+e+'">'+e+"</option>"),e--}function e(){h(o.currentIndex);var a=g(p[o.currentIndex]["date-full"],"DD MMM YYYY");o.currentYear=a.format("YYYY"),o.currentMonth=a.format("M"),o.currentFormatted=a.format("YYYY MMMM"),f('select[name="month"]',q).val(a.format("MMM")).selectric("refresh"),f('select[name="year"]',q).val(a.format("YYYY")).selectric("refresh")}function h(a){var b=m.getPos(a);m.slideTo(b.center),m.activate(a);var c=n.getPos(a);n.slideTo(c.start),n.activate(a)}function i(a){k.width(a),setTimeout(function(){m.reload()},1)}var j,k,l,m,n,o={},p=this.config("timeline-items"),q=f(a[0][0]);f(".timeline-widget-frames li a").attr("target","_blank"),c(),f(".timeline-widget-dropdown--list-item",q).click(function(){o.currentIndex=f(this).attr("data-slide"),e()}),f(".timeline-widget--dropdown-heading, .close",q).click(function(){f(".timeline-widget--dropdown--wrapper").toggleClass("open"),n.reload()}),f(".timeline-widget-dropdown--item",q).click(function(){f(".timeline-widget--dropdown--wrapper").removeClass("open")}),f(".timeline-widget--dropdown-controls select",q).on("selectric-change",function(){for(var a,b,c=f('select[name="month"]',q).val()+" "+f('select[name="year"]',q).val(),d=g(c,"MMM YYYY").unix(),h=0;h<p.length;h++)if(b=p[h],a=g(b["date-full"],"DD MMM YYYY").unix(),a>d){o.currentIndex=h,e();break}}),f(".form-today",q).click(function(){o.currentIndex=b(),e()}),m.on("moveStart",function(){o.currentIndex=m.rel.activeItem,e()})},b.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./timeline.hbs.js":7}],9:[function(a,b){(function(c){"use strict";var d="undefined"!=typeof window?window.BeatBlocks:"undefined"!=typeof c?c.BeatBlocks:null,e=a("./components/crisis-overview/crisis-overview"),f=a("./components/river/river"),g=a("./components/timeline/timeline"),h=a("./components/financial/financial");d.addWidgetToRegistry("crisis-overview",e),d.addWidgetToRegistry("river",f),d.addWidgetToRegistry("timeline",g),d.addWidgetToRegistry("financial",h),b.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./components/crisis-overview/crisis-overview":2,"./components/financial/financial":4,"./components/river/river":6,"./components/timeline/timeline":8}]},{},[9]);